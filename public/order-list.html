<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="BookHaven - 訂單管理">
    <title>訂單管理 - BookHaven Dashboard</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=figtree:400,500,600&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/order-list.css">
</head>
<body>
    <!-- Header Navigation -->
    <header class="dashboard-header">
        <nav class="dashboard-nav">
            <div class="nav-brand">
                <a href="index.html" class="logo">BookHaven</a>
                <span class="dashboard-label">管理後台</span>
            </div>
            
            <ul class="nav-menu">
                <li><a href="dashboard.html">儀表板</a></li>
                <li><a href="dashboard.html#books">書籍管理</a></li>
                <li><a href="order-list.html" class="active">訂單管理</a></li>
                <li><a href="#users">用戶管理</a></li>
                <li><a href="#settings">系統設定</a></li>
            </ul>
            
            <div class="nav-actions">
                <button class="notification-btn">
                    <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span class="notification-badge">3</span>
                </button>
                
                <div class="user-menu">
                    <button class="user-btn" id="userMenuBtn">
                        <div class="user-avatar">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <span class="user-name">管理員</span>
                        <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    
                    <div class="user-dropdown" id="userDropdown">
                        <a href="#profile">個人資料</a>
                        <a href="#settings">帳號設定</a>
                        <hr>
                        <a href="index.html">返回前台</a>
                        <a href="#logout" class="logout">登出</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="dashboard-container">
        <div class="dashboard-content">
            <!-- Page Title -->
            <div class="page-header">
                <h1 class="page-title">訂單管理</h1>
            </div>

            <!-- Statistics Cards -->
            <!-- Statistics Cards -->
            <div class="order-stats">
                <div class="order-stat-card total">
                    <div class="stat-label">總計</div>
                    <div class="stat-number" id="totalOrders">6</div>
                </div>
                <div class="order-stat-card pending">
                    <div class="stat-label">待確認</div>
                    <div class="stat-number" id="pendingOrders">1</div>
                </div>
                <div class="order-stat-card confirmed">
                    <div class="stat-label">已確認</div>
                    <div class="stat-number" id="confirmedOrders">1</div>
                </div>
                <div class="order-stat-card shipped">
                    <div class="stat-label">已出貨</div>
                    <div class="stat-number" id="shippedOrders">0</div>
                </div>
                <div class="order-stat-card finished">
                    <div class="stat-label">已完成</div>
                    <div class="stat-number" id="finishedOrders">4</div>
                </div>
                <div class="order-stat-card cancelled">
                    <div class="stat-label">已取消</div>
                    <div class="stat-number" id="cancelledOrders">0</div>
                </div>
            </div>

            <!-- Filters
            <div class="filter-card">
                <form id="filterForm" class="filter-form">
                    <div class="filter-grid">

                        <div class="filter-item">
                            <label class="filter-label">搜尋</label>
                            <input type="text" 
                                   id="searchInput" 
                                   class="filter-input" 
                                   placeholder="訂單編號 / 收件人 / 電話">
                        </div>

                        <div class="filter-item">
                            <label class="filter-label">訂單狀態</label>
                            <select id="statusFilter" class="filter-select">
                                <option value="">全部狀態</option>
                                <option value="pending">待確認</option>
                                <option value="confirmed">已確認</option>
                                <option value="shipped">已出貨</option>
                                <option value="finished">已完成</option>
                                <option value="cancelled">已取消</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">付款狀態</label>
                            <select id="paymentFilter" class="filter-select">
                                <option value="">全部狀態</option>
                                <option value="unpaid">未付款</option>
                                <option value="paid">已付款</option>
                                <option value="refunded">已退款</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">訂單日期</label>
                            <div class="date-range">
                                <input type="date" id="dateFrom" class="filter-input date-input">
                                <span class="date-separator">至</span>
                                <input type="date" id="dateTo" class="filter-input date-input">
                            </div>
                        </div>
                    </div>

                    <div class="filter-actions">
                        <button type="submit" class="btn btn-primary">搜尋</button>
                        <button type="button" class="btn btn-secondary" onclick="resetFilters()">重置</button>
                    </div>
                </form>
            </div>
            -->

            <!-- Batch Actions 
            <div class="batch-actions-card">
                <div class="batch-actions-content">
                    <div class="batch-actions-left">
                        <span class="batch-label">批量操作：</span>
                        <button type="button" class="batch-btn confirm" onclick="batchAction('confirm')">
                            確認訂單
                        </button>
                        <button type="button" class="batch-btn ship" onclick="batchAction('ship')">
                            標記出貨
                        </button>
                        <button type="button" class="batch-btn finish" onclick="batchAction('finish')">
                            完成訂單
                        </button>
                        <button type="button" class="batch-btn cancel" onclick="batchAction('cancel')">
                            取消訂單
                        </button>
                    </div>
                    <span id="selectedCount" class="selected-count">已選擇 0 筆</span>
                </div>
            </div>-->
            
            <!-- Filters & Batch Actions -->
            <div class="filter-card">
                <form id="filterForm" class="filter-form">
                    <div class="filter-grid">
                        <!-- 搜尋框 -->
                        <div class="filter-item">
                            <label class="filter-label">搜尋</label>
                            <input type="text" 
                                id="searchInput" 
                                class="filter-input" 
                                placeholder="訂單編號 / 收件人 / 電話">
                        </div>

                        <!-- 訂單狀態 -->
                        <div class="filter-item">
                            <label class="filter-label">訂單狀態</label>
                            <select id="statusFilter" class="filter-select">
                                <option value="">全部狀態</option>
                                <option value="pending">待確認</option>
                                <option value="confirmed">已確認</option>
                                <option value="shipped">已出貨</option>
                                <option value="finished">已完成</option>
                                <option value="cancelled">已取消</option>
                            </select>
                        </div>

                        <!-- 付款狀態 -->
                        <div class="filter-item">
                            <label class="filter-label">付款狀態</label>
                            <select id="paymentFilter" class="filter-select">
                                <option value="">全部狀態</option>
                                <option value="unpaid">未付款</option>
                                <option value="paid">已付款</option>
                                <option value="refunded">已退款</option>
                            </select>
                        </div>

                        <!-- 日期範圍 -->
                        <div class="filter-item">
                            <label class="filter-label">訂單日期</label>
                            <div class="date-range">
                                <input type="date" id="dateFrom" class="filter-input date-input">
                                <span class="date-separator">至</span>
                                <input type="date" id="dateTo" class="filter-input date-input">
                            </div>
                        </div>
                    </div>

                    <!-- 操作按鈕區 -->
                    <div class="actions-row">
                        <div class="filter-actions">
                            <button type="submit" class="btn btn-primary btn-search">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                搜尋
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetFilters()">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                重置
                            </button>
                        </div>

                        <div class="batch-actions-divider"></div>

                        <div class="batch-actions-group">
                            <span class="batch-label">批量操作：</span>
                            <button type="button" class="batch-btn confirm" onclick="batchAction('confirm')">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                確認訂單
                            </button>
                            <button type="button" class="batch-btn ship" onclick="batchAction('ship')">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path>
                                </svg>
                                標記出貨
                            </button>
                            <button type="button" class="batch-btn finish" onclick="batchAction('finish')">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                完成訂單
                            </button>
                            <button type="button" class="batch-btn cancel" onclick="batchAction('cancel')">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                                取消訂單
                            </button>
                        </div>

                        <span id="selectedCount" class="selected-count">已選擇 0 筆</span>
                    </div>
                </form>
            </div>
            <!-- Orders Table -->
            <div class="orders-table-card">
                <div class="table-wrapper">
                    <table class="orders-table">
                        <thead>
                            <tr>
                                <th class="th-checkbox">
                                    <input type="checkbox" id="selectAll" class="table-checkbox">
                                </th>
                                <th>訂單資訊</th>
                                <th>收件人</th>
                                <th>商品</th>
                                <th>金額</th>
                                <th>狀態</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- 訂單列表將由 JavaScript 動態生成 -->
                             <!-- 訂單行模板（隱藏） -->
                            <!-- 訂單行模板（隱藏） -->
                            <template id="orderRowTemplate">
                                <tr>
                                    <td>
                                        <input type="checkbox" class="order-checkbox table-checkbox" data-order-id="">
                                    </td>
                                    <td>
                                        <div class="order-number"></div>
                                        <div class="order-date"></div>
                                    </td>
                                    <td>
                                        <div class="recipient-name"></div>
                                        <div class="recipient-phone"></div>
                                    </td>
                                    <td>
                                        <div class="order-product-info">
                                            <img src="" alt="" class="order-product-image">
                                            <div>
                                                <div class="order-product-title"></div>
                                                <div class="order-product-extra"></div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="order-amount"></div>
                                        <div class="order-subtotal"></div>
                                    </td>
                                    <td>
                                        <div class="status-badges">
                                            <span class="status-badge order-status-badge"></span>
                                            <span class="status-badge payment-status-badge"></span>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="table-actions">
                                            <a href="order-detail.html" class="action-link view-link">查看</a>
                                            <a href="javascript:void(0)" class="action-link update-link">更新</a>
                                        </div>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h3>尚無訂單資料</h3>
                    <p>調整搜尋條件或等待新訂單</p>
                </div>

                <!-- Pagination -->
                <div class="pagination-container" id="paginationContainer">
                    <div class="pagination">
                        <button class="pagination-btn pagination-prev" id="prevPageBtn" disabled>
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                            <span>上一頁</span>
                        </button>
                        
                        <div class="pagination-numbers" id="paginationNumbers">
                            <!-- 頁碼將由 JavaScript 動態生成 -->
                        </div>
                        
                        <button class="pagination-btn pagination-next" id="nextPageBtn">
                            <span>下一頁</span>
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="pagination-info">
                        顯示第 <span id="currentStart">1</span> - <span id="currentEnd">10</span> 項，共 <span id="totalItems">0</span> 項
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Update Modal -->
    <div class="modal-overlay" id="statusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">更新訂單狀態</h3>
                <button class="modal-close" onclick="hideStatusModal()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <form id="statusForm" class="modal-form">
                <input type="hidden" id="orderId">

                <div class="form-group">
                    <label class="form-label">訂單狀態</label>
                    <select id="orderStatus" class="form-select">
                        <option value="pending">待確認</option>
                        <option value="confirmed">已確認</option>
                        <option value="shipped">已出貨</option>
                        <option value="finished">已完成</option>
                        <option value="cancelled">已取消</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">管理員備註</label>
                    <textarea id="adminNote" class="form-textarea" rows="3" placeholder="選填"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideStatusModal()">取消</button>
                    <button type="submit" class="btn btn-primary">更新</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/order-list.js"></script>
</body>
</html>